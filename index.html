<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>แบบฝึกหัดออนไลน์</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            padding: 20px;
            text-align: center;
        }
        .exercise {
            background-color: #fff;
            padding: 10px;
            margin: 5px 0;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        input, select, button {
            font-size: 16px;
            margin: 5px;
            padding: 10px;
        }
        @media (max-width: 600px) {
            input, button, select {
                width: 90%;
            }
        }
    </style>
</head>
<body>

<h1>แบบฝึกหัดออนไลน์</h1>

<div id="subjectSelect">
    <label>เลือกวิชา:</label>
    <select id="subject">
        <option value="math">คณิตศาสตร์</option>
        <option value="thai">ภาษาไทย</option>
        <option value="science">วิทยาศาสตร์</option>
    </select>
    <button onclick="startExercise()">เริ่มทำแบบฝึกหัด</button>
</div>

<div id="mathSection" style="display:none;">
    <h2>แบบฝึกหัดคณิตศาสตร์</h2>
    <label>เลือกรูปแบบโจทย์:</label>
    <select id="mathType">
        <option value="simple">แบบธรรมดา (11+22)</option>
        <option value="bracket">แบบมีวงเล็บ (50 - (10+4))</option>
    </select>
    <button onclick="generateMathExercises()">สร้างโจทย์</button>
    <button onclick="checkMathAnswers()">ตรวจคำตอบ</button>
    <button onclick="goBack()">กลับไปเลือกวิชา</button>
    <div id="mathExercises"></div>
    <div id="mathResult"></div>
</div>

<div id="thaiSection" style="display:none;">
    <h2>แบบฝึกหัดภาษาไทย: มาตราตัวสะกด</h2>
    <button onclick="generateThaiExercises()">สร้างโจทย์</button>
    <button onclick="checkThaiAnswers()">ตรวจคำตอบ</button>
    <button onclick="goBack()">กลับไปเลือกวิชา</button>
    <div id="thaiExercises"></div>
    <div id="thaiResult"></div>
</div>

<script>
function goBack() {
    document.getElementById('subjectSelect').style.display = 'block';
    document.getElementById('mathSection').style.display = 'none';
    document.getElementById('thaiSection').style.display = 'none';
}

function startExercise() {
    const subject = document.getElementById('subject').value;

    document.getElementById('subjectSelect').style.display = 'none';
    document.getElementById('mathSection').style.display = 'none';
    document.getElementById('thaiSection').style.display = 'none';

    if (subject === 'math') {
        document.getElementById('mathSection').style.display = 'block';
        generateMathExercises();
    } else if (subject === 'thai') {
        document.getElementById('thaiSection').style.display = 'block';
        generateThaiExercises();
    } else {
        alert('วิชานี้ยังไม่มีแบบฝึกหัด');
        goBack();
    }
}

// === คณิตศาสตร์ ===
function randomTwoDigit() {
    return Math.floor(Math.random() * 90) + 10;
}

function createSimpleMath() {
    const num1 = randomTwoDigit();
    const num2 = randomTwoDigit();
    const op = Math.random() > 0.5 ? '+' : '-';
    if (op === '-' && num1 < num2) return createSimpleMath();

    return { text: `${num1} ${op} ${num2}`, answer: op === '+' ? num1 + num2 : num1 - num2 };
}

function createBracketMath() {
    const outer = randomTwoDigit();
    const inner1 = randomTwoDigit();
    const inner2 = randomTwoDigit();
    const innerOp = Math.random() > 0.5 ? '+' : '-';

    let innerResult = innerOp === '+' ? inner1 + inner2 : inner1 - inner2;
    if (innerResult < 0) return createBracketMath();

    const outerOp = Math.random() > 0.5 ? '+' : '-';
    let result = outerOp === '+' ? outer + innerResult : outer - innerResult;
    if (result < 0) return createBracketMath();

    return { text: `${outer} ${outerOp} (${inner1} ${innerOp} ${inner2})`, answer: result };
}

function generateMathExercises() {
    const type = document.getElementById('mathType').value;
    const exercisesDiv = document.getElementById('mathExercises');
    exercisesDiv.innerHTML = '';

    for (let i = 0; i < 10; i++) {
        const exercise = type === 'simple' ? createSimpleMath() : createBracketMath();
        exercisesDiv.innerHTML += `<div class="exercise">${i+1}. ${exercise.text} = <input type="number" class="mathAnswer" data-answer="${exercise.answer}"></div>`;
    }
    document.getElementById('mathResult').innerText = '';
}

function checkMathAnswers() {
    const inputs = document.querySelectorAll('.mathAnswer');
    let score = 0;
    inputs.forEach(input => {
        if (parseInt(input.value) === parseInt(input.dataset.answer)) {
            input.style.backgroundColor = 'lightgreen';
            score++;
        } else {
            input.style.backgroundColor = 'lightcoral';
        }
    });
    document.getElementById('mathResult').innerText = `คุณได้ ${score}/10 คะแนน`;
}

// === ภาษาไทย - มาตราตัวสะกด ===
const thaiExercises = [
    { word: 'จักรยาน', correct: 'แม่กก' },
    { word: 'ดอกไม้', correct: 'แม่กก' },
    { word: 'ลำไย', correct: 'แม่กง' },
    { word: 'ภาพวาด', correct: 'แม่กด' },
    { word: 'สนาม', correct: 'แม่กม' },
    { word: 'เด็กน้อย', correct: 'แม่กก' },
    { word: 'ตลาด', correct: 'แม่กด' },
    { word: 'นาฬิกา', correct: 'แม่กน' },
    { word: 'ปลาทู', correct: 'แม่กง' },
    { word: 'แม่น้ำ', correct: 'แม่กม' }
];

function generateThaiExercises() {
    const exercisesDiv = document.getElementById('thaiExercises');
    exercisesDiv.innerHTML = '';
    thaiExercises.sort(() => 0.5 - Math.random()).slice(0, 5).forEach((ex, i) => {
        exercisesDiv.innerHTML += `<div class="exercise">${i+1}. คำว่า "${ex.word}" อยู่ในมาตรา <input type="text" class="thaiAnswer" data-answer="${ex.correct}"></div>`;
    });
    document.getElementById('thaiResult').innerText = '';
}

function checkThaiAnswers() {
    const inputs = document.querySelectorAll('.thaiAnswer');
    let score = 0;
    inputs.forEach(input => {
        if (input.value.trim() === input.dataset.answer) {
            input.style.backgroundColor = 'lightgreen';
            score++;
        } else {
            input.style.backgroundColor = 'lightcoral';
        }
    });
    document.getElementById('thaiResult').innerText = `คุณได้ ${score}/5 คะแนน`;
}
</script>

</body>
</html>
